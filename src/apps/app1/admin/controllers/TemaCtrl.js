angular.module("APP-CLASIFICADOR-ADMIN").controller("TemaCtrl",["$scope","$location","$compile","PARAMETROS","CommonAjaxService","CommonLog","AppModelService","$rootScope",function(e,a,t,m,u,o,b,n){function s(a,t){var u=m.MSG.FTM_TEMA_YA_EXISTE.cformat(a);g_utils.prompt_msg(u,(function(){e.$apply(t())}))}function i(a,t){switch(t){case 0:var u={idTemaPadre:"TemaIA",nombreTema:a};b.post(m.URL.agregar_tema,u,(function(t){t.data.success?e.dx.nombreTema={id:t.data.data,nombre:a}:t.data.msg&&t.data.msg.length>2&&s("tema",(function(){e.temaBloqueo=!1,e.subtemaBloqueo=!0}))}));break;case 1:u={idTemaPadre:e.dx.nombreTema.id,nombreTema:a};b.post(m.URL.agregar_tema,u,(function(t){t.data.success?e.dx.nombreSubTema={id:t.data.data,nombre:a}:t.data.msg&&t.data.msg.length>2&&s("subtema",(function(){e.subtemaBloqueo=!1,e.subsubtemaBloqueo=!0}))}));break;case 2:u={idTemaPadre:e.dx.nombreSubTema.id,nombreTema:a};b.post(m.URL.agregar_tema,u,(function(t){t.data.success?e.dx.nombreSubSubTema={id:t.data.data,nombre:a}:t.data.msg&&t.data.msg.length>2&&s("subsubtema",(function(){e.subsubtemaBloqueo=!1,e.showNuevoTemaB=!1}))}));break}}function d(a,t){switch(t){case 0:var u={id:a.id};b.getList(m.URL.get_list_tipo_tema,u,(function(a){a.data.success&&(e.get_list_subtipo_tema=a.data.data)}));break;case 1:u={id:a.id};b.getList(m.URL.get_list_tipo_tema,u,(function(a){a.data.success&&(e.get_list_subsubtipo_tema=a.data.data)}));break}}n.currentViewName="Temas",e.dx={tema_r:null,nombreTema:null,i_nombreTema:null,nombreSubTema:null,i_nombreSubTema:null,nombreSubSubTema:null,i_nombreSubSubTema:null},e.temaBloqueo=!1,e.subtemaBloqueo=!0,e.subsubtemaBloqueo=!0,e.guardarTema=function(){e.temaValidate=!(!e.dx.nombreTema&&!e.dx.i_nombreTema),e.temaValidate&&("tema"===e.dx.tema_r?i(e.dx.i_nombreTema,0):d(e.dx.nombreTema,0),e.temaBloqueo=!0,e.subtemaBloqueo=!1)},e.guardarSubTema=function(){e.subtemaValidate=!(!e.dx.nombreSubTema&&!e.dx.i_nombreSubTema),e.subtemaValidate&&("tema"!==e.dx.tema_r&&"subtema"!==e.dx.tema_r||i(e.dx.i_nombreSubTema,1),"subsubtema"===e.dx.tema_r&&d(e.dx.nombreSubTema,1),e.subtemaBloqueo=!0,e.subsubtemaBloqueo=!1)},e.guardarSubSubTema=function(){e.subsubtemaValidate=!(!e.dx.nombreSubSubTema&&!e.dx.i_nombreSubSubTema),e.subsubtemaValidate&&(i(e.dx.i_nombreSubSubTema,2),e.subsubtemaBloqueo=!0,e.showNuevoTemaB=!0)},e.limpiarTemas=function(){e.dx={tema_r:null,nombreTema:null,i_nombreTema:null,nombreSubTema:null,i_nombreSubTema:null,nombreSubSubTema:null,i_nombreSubSubTema:null},e.temaBloqueo=!1,e.subtemaBloqueo=!0,e.subsubtemaBloqueo=!0,e.showTema=!1,e.showNuevoTemaB=!1;b.getList(m.URL.get_list_tipo_tema,{id:"TemaIA"},(function(a){a.data.success&&(e.get_list_tipo_tema=a.data.data)}))},e.logout=function(){a.path(m.APP1.ACTION.LOGIN)},b.getList(m.URL.get_list_tipo_tema,{id:"TemaIA"},(function(a){a.data.success&&(e.get_list_tipo_tema=a.data.data)}))}]);