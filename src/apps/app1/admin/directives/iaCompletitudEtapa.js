angular.module("APP-CLASIFICADOR-ADMIN").directive("iaCompletitudEtapa",["PARAMETROS","AppModelService","$interval",function(t,a,e){return{restrict:"AE",replace:!0,link:function(l,i,o,p){function n(){l.dx.interval&&e.cancel(l.dx.interval),l.dx.interval=e((function(){switch(l.dx.etapa_actual){case a.CONSTANTE.ORIGEN:c(l.dx.completitud.origen);break;case a.CONSTANTE.CONTENIDO:c(l.dx.completitud.contenido);break;case a.CONSTANTE.VALORACION:c(l.dx.completitud.valoracion);break;case a.CONSTANTE.CLASIFICACION:c(l.dx.completitud.clasificacion);break}}),t.INTERVAL_ETAPA)}function c(t){var a=new moment,e=moment.utc(moment(a).diff(l.dx.start_moment)),i=g_utils.padZero(e.get("hours"),2)+":"+g_utils.padZero(e.get("minutes"),2)+":"+g_utils.padZero(e.get("seconds"),2);t.tiempoCaptura=i,t.tiempoTotal=i}l.dx={interval:null,start_moment:null,etapa_actual:null,completitud:null},l.$parent.$watch("app_model.completitud_etapa.etapa_actual",(function(){l.app_model.completitud_etapa&&l.app_model.completitud_etapa.etapa_actual&&(l.dx.start_moment=new moment,l.dx.completitud=l.app_model.completitud_etapa,l.dx.etapa_actual=l.app_model.completitud_etapa.etapa_actual,n())})),l.$on(t.EVENTOS.restart_clasificacion,(function(){l.dx.start_moment=new moment,n()}))},templateUrl:"apps/app1/admin/directives/templates/iaCompletitudEtapa.html"}}]);