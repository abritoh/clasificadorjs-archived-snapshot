angular.module("Authentication").factory("AuthenticationService",["Base64","$http","$cookieStore","$rootScope","$timeout","$log","Idle","PARAMETROS","CommonAjaxService",function(e,o,a,t,r,s,i,n,u){var c={Login:function(e,a,t){switch(n.URL.login_service.FORCE){case"SERVICE":var i={method:"POST",url:u.getUrl(n.URL.login_service),headers:{"Content-Type":"application/json; charset=utf-8"},data:{usuario:e,password:a,aplicacion:n.ID_APLICACION}};o(i).success((function(e){s.info(e);var o={success:e.success,data:e.data};t(o)})).error((function(e){s.error(e);t({success:!1,data:{nombre:"Sofia",paterno:"Nova",materno:"Cipher",foto:""}})}));break;case"LOCAL":r((function(){var o={success:"admin"===e.toLowerCase()&&"admin"===a.toLowerCase(),data:{ip:"192.168.1.81",nombre:"Sofia",paterno:"Nova",materno:"Cipher",numEmpleado:"SPF007",password:"pa$$word",puesto:"Cybercrime and Artificial Intelligence Investigations",sistema:"2",tipoOperacion:null,usuario:"admin",foto:"./assets/images/card/police-1.png"}};o.success||(o.message="Username or password is incorrect"),t(o)}),1e3);break}},SetCredentials:function(r,s){var i=e.encode(r.usuario+":"+r.password);t.globals={currentUser:{username:r.usuario,authdata:i,nombre:g_utils.getUsrName(s,!1)},infoUser:{nombre:g_utils.getUsrName(s,!0),foto:s.foto,puesto:s.rol,numEmpleado:s.numEmpleado,usuario:s.usuario}};var u={path:"/",domain:g_utils.get_site_domain()},c=$.extend(!0,{},t.globals);c.infoUser.foto="",o.defaults.headers.common.Authorization="Basic "+i,a.put(n.GLOBAL_COOKIE,c,u)},ClearCredentials:function(){t.globals={},a.remove(n.GLOBAL_COOKIE),o.defaults.headers.common.Authorization="Basic ",a.remove("timeout"),a.remove("timeout_routing"),i.unwatch()}};return c}]);